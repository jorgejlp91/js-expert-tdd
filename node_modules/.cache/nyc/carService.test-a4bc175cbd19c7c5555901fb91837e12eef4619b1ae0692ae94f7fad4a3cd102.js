function cov_1n05bena14(){var path="/home/jorge/projetos/pessoais/curso-erickwendel/js-expert/01-testing/aula05-tdd/test/unitTests/carService.test.js";var hash="b2ffb3756a3541c950ba6c3b500e685e4da74e68";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/jorge/projetos/pessoais/curso-erickwendel/js-expert/01-testing/aula05-tdd/test/unitTests/carService.test.js",statementMap:{"0":{start:{line:1,column:56},end:{line:1,column:72}},"1":{start:{line:2,column:19},end:{line:2,column:58}},"2":{start:{line:3,column:15},end:{line:3,column:30}},"3":{start:{line:4,column:17},end:{line:4,column:32}},"4":{start:{line:5,column:14},end:{line:5,column:30}},"5":{start:{line:6,column:20},end:{line:6,column:61}},"6":{start:{line:8,column:21},end:{line:8,column:69}},"7":{start:{line:10,column:14},end:{line:14,column:1}},"8":{start:{line:15,column:0},end:{line:138,column:2}},"9":{start:{line:16,column:21},end:{line:16,column:23}},"10":{start:{line:17,column:18},end:{line:17,column:20}},"11":{start:{line:18,column:4},end:{line:22,column:6}},"12":{start:{line:19,column:8},end:{line:21,column:10}},"13":{start:{line:24,column:4},end:{line:26,column:6}},"14":{start:{line:25,column:8},end:{line:25,column:39}},"15":{start:{line:28,column:4},end:{line:30,column:6}},"16":{start:{line:29,column:8},end:{line:29,column:25}},"17":{start:{line:32,column:4},end:{line:37,column:6}},"18":{start:{line:33,column:21},end:{line:33,column:32}},"19":{start:{line:34,column:23},end:{line:34,column:57}},"20":{start:{line:36,column:8},end:{line:36,column:59}},"21":{start:{line:39,column:4},end:{line:54,column:6}},"22":{start:{line:40,column:28},end:{line:40,column:50}},"23":{start:{line:41,column:27},end:{line:41,column:28}},"24":{start:{line:43,column:8},end:{line:46,column:29}},"25":{start:{line:48,column:23},end:{line:48,column:62}},"26":{start:{line:49,column:25},end:{line:49,column:55}},"27":{start:{line:51,column:8},end:{line:51,column:64}},"28":{start:{line:52,column:8},end:{line:52,column:44}},"29":{start:{line:56,column:4},end:{line:77,column:6}},"30":{start:{line:57,column:20},end:{line:57,column:34}},"31":{start:{line:58,column:28},end:{line:58,column:65}},"32":{start:{line:59,column:8},end:{line:59,column:37}},"33":{start:{line:61,column:8},end:{line:64,column:23}},"34":{start:{line:66,column:8},end:{line:69,column:9}},"35":{start:{line:71,column:23},end:{line:71,column:68}},"36":{start:{line:72,column:25},end:{line:72,column:28}},"37":{start:{line:74,column:8},end:{line:74,column:62}},"38":{start:{line:75,column:8},end:{line:75,column:80}},"39":{start:{line:76,column:8},end:{line:76,column:49}},"40":{start:{line:79,column:4},end:{line:102,column:6}},"41":{start:{line:80,column:25},end:{line:80,column:59}},"42":{start:{line:81,column:8},end:{line:81,column:25}},"43":{start:{line:83,column:28},end:{line:83,column:65}},"44":{start:{line:84,column:8},end:{line:84,column:32}},"45":{start:{line:86,column:29},end:{line:86,column:30}},"46":{start:{line:88,column:8},end:{line:91,column:49}},"47":{start:{line:91,column:19},end:{line:91,column:48}},"48":{start:{line:93,column:25},end:{line:93,column:65}},"49":{start:{line:94,column:23},end:{line:98,column:9}},"50":{start:{line:100,column:8},end:{line:100,column:49}},"51":{start:{line:104,column:4},end:{line:137,column:6}},"52":{start:{line:105,column:20},end:{line:105,column:34}},"53":{start:{line:106,column:28},end:{line:110,column:9}},"54":{start:{line:112,column:25},end:{line:112,column:59}},"55":{start:{line:113,column:8},end:{line:113,column:25}},"56":{start:{line:115,column:29},end:{line:115,column:30}},"57":{start:{line:116,column:24},end:{line:116,column:48}},"58":{start:{line:118,column:22},end:{line:118,column:41}},"59":{start:{line:119,column:8},end:{line:119,column:46}},"60":{start:{line:121,column:8},end:{line:124,column:23}},"61":{start:{line:126,column:31},end:{line:126,column:71}},"62":{start:{line:127,column:23},end:{line:127,column:79}},"63":{start:{line:129,column:25},end:{line:134,column:10}},"64":{start:{line:136,column:8},end:{line:136,column:49}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:15,column:36},end:{line:15,column:37}},loc:{start:{line:15,column:42},end:{line:138,column:1}},line:15},"1":{name:"(anonymous_1)",decl:{start:{line:18,column:11},end:{line:18,column:12}},loc:{start:{line:18,column:17},end:{line:22,column:5}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:15},end:{line:24,column:16}},loc:{start:{line:24,column:20},end:{line:26,column:5}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:28,column:14},end:{line:28,column:15}},loc:{start:{line:28,column:19},end:{line:30,column:5}},line:28},"4":{name:"(anonymous_4)",decl:{start:{line:32,column:58},end:{line:32,column:59}},loc:{start:{line:32,column:63},end:{line:37,column:5}},line:32},"5":{name:"(anonymous_5)",decl:{start:{line:39,column:64},end:{line:39,column:65}},loc:{start:{line:39,column:70},end:{line:54,column:5}},line:39},"6":{name:"(anonymous_6)",decl:{start:{line:56,column:63},end:{line:56,column:64}},loc:{start:{line:56,column:76},end:{line:77,column:5}},line:56},"7":{name:"(anonymous_7)",decl:{start:{line:79,column:98},end:{line:79,column:99}},loc:{start:{line:79,column:109},end:{line:102,column:5}},line:79},"8":{name:"(anonymous_8)",decl:{start:{line:91,column:14},end:{line:91,column:15}},loc:{start:{line:91,column:19},end:{line:91,column:48}},line:91},"9":{name:"(anonymous_9)",decl:{start:{line:104,column:85},end:{line:104,column:86}},loc:{start:{line:104,column:97},end:{line:137,column:5}},line:104}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b2ffb3756a3541c950ba6c3b500e685e4da74e68"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1n05bena14=function(){return actualCoverage;};}return actualCoverage;}cov_1n05bena14();const{describe,it,before,beforeEach,afterEach}=(cov_1n05bena14().s[0]++,require('mocha'));const CarService=(cov_1n05bena14().s[1]++,require('../../src/service/carService'));const{join}=(cov_1n05bena14().s[2]++,require('path'));const{expect}=(cov_1n05bena14().s[3]++,require('chai'));const sinon=(cov_1n05bena14().s[4]++,require('sinon'));const Transaction=(cov_1n05bena14().s[5]++,require('../../src/entities/transaction'));const carsDatabase=(cov_1n05bena14().s[6]++,join(__dirname,'./../../database',"cars.json"));const mocks=(cov_1n05bena14().s[7]++,{validCarCategory:require('./../mocks/valid-carCategory.json'),validCar:require('./../mocks/valid-car.json'),validCustomer:require('./../mocks/valid-customer.json')});cov_1n05bena14().s[8]++;describe('CarSerivece Suite Tests',()=>{cov_1n05bena14().f[0]++;let carService=(cov_1n05bena14().s[9]++,{});let sandbox=(cov_1n05bena14().s[10]++,{});cov_1n05bena14().s[11]++;before(()=>{cov_1n05bena14().f[1]++;cov_1n05bena14().s[12]++;carService=new CarService({cars:carsDatabase});});cov_1n05bena14().s[13]++;beforeEach(()=>{cov_1n05bena14().f[2]++;cov_1n05bena14().s[14]++;sandbox=sinon.createSandbox();});cov_1n05bena14().s[15]++;afterEach(()=>{cov_1n05bena14().f[3]++;cov_1n05bena14().s[16]++;sandbox.restore();});cov_1n05bena14().s[17]++;it('should retrieve a random position from an array',()=>{cov_1n05bena14().f[4]++;const data=(cov_1n05bena14().s[18]++,[0,1,2,3,4]);const result=(cov_1n05bena14().s[19]++,carService.getRandomPosition(data));cov_1n05bena14().s[20]++;expect(result).to.be.lte(data.length).and.be.gte(0);});cov_1n05bena14().s[21]++;it('should choose the first id from carIds in carCategory',()=>{cov_1n05bena14().f[5]++;const carCategory=(cov_1n05bena14().s[22]++,mocks.validCarCategory);const carIdIndex=(cov_1n05bena14().s[23]++,0);cov_1n05bena14().s[24]++;sandbox.stub(carService,carService.getRandomPosition.name).returns(carIdIndex);const result=(cov_1n05bena14().s[25]++,carService.chooseRandomCar(carCategory));const expected=(cov_1n05bena14().s[26]++,carCategory.carIds[carIdIndex]);cov_1n05bena14().s[27]++;expect(carService.getRandomPosition.calledOnce).to.be.ok;cov_1n05bena14().s[28]++;expect(result).to.be.equal(expected);});cov_1n05bena14().s[29]++;it('given a carCategoy it should return an available car',async()=>{cov_1n05bena14().f[6]++;const car=(cov_1n05bena14().s[30]++,mocks.validCar);const carCategory=(cov_1n05bena14().s[31]++,Object.create(mocks.validCarCategory));cov_1n05bena14().s[32]++;carCategory.carIds=[car.id];cov_1n05bena14().s[33]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);cov_1n05bena14().s[34]++;sandbox.spy(carService,carService.chooseRandomCar.name);const result=(cov_1n05bena14().s[35]++,await carService.getAvailableCar(carCategory));const expected=(cov_1n05bena14().s[36]++,car);cov_1n05bena14().s[37]++;expect(carService.chooseRandomCar.calledOnce).to.be.ok;cov_1n05bena14().s[38]++;expect(carService.carRepository.find.calledWithExactly(car.id)).to.be.ok;cov_1n05bena14().s[39]++;expect(result).to.be.deep.equal(expected);});cov_1n05bena14().s[40]++;it('given a carCategory, customer and numberOfDays it should calculate final amount in real',async()=>{cov_1n05bena14().f[7]++;const customer=(cov_1n05bena14().s[41]++,Object.create(mocks.validCustomer));cov_1n05bena14().s[42]++;customer.age=50;const carCategory=(cov_1n05bena14().s[43]++,Object.create(mocks.validCarCategory));cov_1n05bena14().s[44]++;carCategory.price=37.6;const numberOfDays=(cov_1n05bena14().s[45]++,5);cov_1n05bena14().s[46]++;sandbox.stub(carService,"taxesBasedOnAge").get(()=>{cov_1n05bena14().f[8]++;cov_1n05bena14().s[47]++;return[{from:40,to:50,then:1.3}];});const expected=(cov_1n05bena14().s[48]++,carService.currencyFormat.format(244.40));const result=(cov_1n05bena14().s[49]++,carService.calculateFinalPrice(customer,carCategory,numberOfDays));cov_1n05bena14().s[50]++;expect(result).to.be.deep.equal(expected);});cov_1n05bena14().s[51]++;it('given a customer and a car category it should return a transaction receipt',async()=>{cov_1n05bena14().f[9]++;const car=(cov_1n05bena14().s[52]++,mocks.validCar);const carCategory=(cov_1n05bena14().s[53]++,{...mocks.validCarCategory,price:37.6,carIds:[car.id]});const customer=(cov_1n05bena14().s[54]++,Object.create(mocks.validCustomer));cov_1n05bena14().s[55]++;customer.age=20;const numberOfDays=(cov_1n05bena14().s[56]++,5);const dueDate=(cov_1n05bena14().s[57]++,"10 de novembro de 2020");const today=(cov_1n05bena14().s[58]++,new Date(2020,10,5));cov_1n05bena14().s[59]++;sandbox.useFakeTimers(today.getTime());cov_1n05bena14().s[60]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);const expectedAmount=(cov_1n05bena14().s[61]++,carService.currencyFormat.format(206.80));const result=(cov_1n05bena14().s[62]++,await carService.rent(customer,carCategory,numberOfDays));const expected=(cov_1n05bena14().s[63]++,new Transaction({customer,car,dueDate,amount:expectedAmount}));cov_1n05bena14().s[64]++;expect(result).to.be.deep.equal(expected);});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMW4wNWJlbmExNCIsImFjdHVhbENvdmVyYWdlIiwiZGVzY3JpYmUiLCJpdCIsImJlZm9yZSIsImJlZm9yZUVhY2giLCJhZnRlckVhY2giLCJzIiwicmVxdWlyZSIsIkNhclNlcnZpY2UiLCJqb2luIiwiZXhwZWN0Iiwic2lub24iLCJUcmFuc2FjdGlvbiIsImNhcnNEYXRhYmFzZSIsIl9fZGlybmFtZSIsIm1vY2tzIiwidmFsaWRDYXJDYXRlZ29yeSIsInZhbGlkQ2FyIiwidmFsaWRDdXN0b21lciIsImYiLCJjYXJTZXJ2aWNlIiwic2FuZGJveCIsImNhcnMiLCJjcmVhdGVTYW5kYm94IiwicmVzdG9yZSIsImRhdGEiLCJyZXN1bHQiLCJnZXRSYW5kb21Qb3NpdGlvbiIsInRvIiwiYmUiLCJsdGUiLCJsZW5ndGgiLCJhbmQiLCJndGUiLCJjYXJDYXRlZ29yeSIsImNhcklkSW5kZXgiLCJzdHViIiwibmFtZSIsInJldHVybnMiLCJjaG9vc2VSYW5kb21DYXIiLCJleHBlY3RlZCIsImNhcklkcyIsImNhbGxlZE9uY2UiLCJvayIsImVxdWFsIiwiY2FyIiwiT2JqZWN0IiwiY3JlYXRlIiwiaWQiLCJjYXJSZXBvc2l0b3J5IiwiZmluZCIsInJlc29sdmVzIiwic3B5IiwiZ2V0QXZhaWxhYmxlQ2FyIiwiY2FsbGVkV2l0aEV4YWN0bHkiLCJkZWVwIiwiY3VzdG9tZXIiLCJhZ2UiLCJwcmljZSIsIm51bWJlck9mRGF5cyIsImdldCIsImZyb20iLCJ0aGVuIiwiY3VycmVuY3lGb3JtYXQiLCJmb3JtYXQiLCJjYWxjdWxhdGVGaW5hbFByaWNlIiwiZHVlRGF0ZSIsInRvZGF5IiwiRGF0ZSIsInVzZUZha2VUaW1lcnMiLCJnZXRUaW1lIiwiZXhwZWN0ZWRBbW91bnQiLCJyZW50IiwiYW1vdW50Il0sInNvdXJjZXMiOlsiY2FyU2VydmljZS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZGVzY3JpYmUsIGl0LCBiZWZvcmUsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCB9ID0gcmVxdWlyZSgnbW9jaGEnKVxuY29uc3QgQ2FyU2VydmljZSA9IHJlcXVpcmUoJy4uLy4uL3NyYy9zZXJ2aWNlL2NhclNlcnZpY2UnKVxuY29uc3Qge2pvaW59ID0gcmVxdWlyZSgncGF0aCcpXG5jb25zdCB7ZXhwZWN0fSA9IHJlcXVpcmUoJ2NoYWknKVxuY29uc3Qgc2lub24gPSByZXF1aXJlKCdzaW5vbicpXG5jb25zdCBUcmFuc2FjdGlvbiA9IHJlcXVpcmUoJy4uLy4uL3NyYy9lbnRpdGllcy90cmFuc2FjdGlvbicpXG5cbmNvbnN0IGNhcnNEYXRhYmFzZSA9IGpvaW4oX19kaXJuYW1lLCAnLi8uLi8uLi9kYXRhYmFzZScsIFwiY2Fycy5qc29uXCIpXG5cbmNvbnN0IG1vY2tzID0ge1xuICAgIHZhbGlkQ2FyQ2F0ZWdvcnk6IHJlcXVpcmUoJy4vLi4vbW9ja3MvdmFsaWQtY2FyQ2F0ZWdvcnkuanNvbicpLFxuICAgIHZhbGlkQ2FyOiByZXF1aXJlKCcuLy4uL21vY2tzL3ZhbGlkLWNhci5qc29uJyksXG4gICAgdmFsaWRDdXN0b21lcjogcmVxdWlyZSgnLi8uLi9tb2Nrcy92YWxpZC1jdXN0b21lci5qc29uJylcbn1cbmRlc2NyaWJlKCdDYXJTZXJpdmVjZSBTdWl0ZSBUZXN0cycsICgpID0+IHtcbiAgICBsZXQgY2FyU2VydmljZSA9IHt9XG4gICAgbGV0IHNhbmRib3ggPSB7fVxuICAgIGJlZm9yZSgoKSA9PiB7XG4gICAgICAgIGNhclNlcnZpY2UgPSBuZXcgQ2FyU2VydmljZSh7XG4gICAgICAgICAgICBjYXJzOiBjYXJzRGF0YWJhc2VcbiAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgYmVmb3JlRWFjaCgoKT0+IHtcbiAgICAgICAgc2FuZGJveCA9IHNpbm9uLmNyZWF0ZVNhbmRib3goKVxuICAgIH0pXG5cbiAgICBhZnRlckVhY2goKCk9PiB7XG4gICAgICAgIHNhbmRib3gucmVzdG9yZSgpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgcmV0cmlldmUgYSByYW5kb20gcG9zaXRpb24gZnJvbSBhbiBhcnJheScsICgpPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gWzAsMSwyLDMsNF1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbihkYXRhKVxuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmx0ZShkYXRhLmxlbmd0aCkuYW5kLmJlLmd0ZSgwKVxuICAgIH0pXG5cbiAgICBpdCgnc2hvdWxkIGNob29zZSB0aGUgZmlyc3QgaWQgZnJvbSBjYXJJZHMgaW4gY2FyQ2F0ZWdvcnknLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhckNhdGVnb3J5ID0gbW9ja3MudmFsaWRDYXJDYXRlZ29yeVxuICAgICAgICBjb25zdCBjYXJJZEluZGV4ID0gMFxuXG4gICAgICAgIHNhbmRib3guc3R1YihcbiAgICAgICAgICAgIGNhclNlcnZpY2UsXG4gICAgICAgICAgICBjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uLm5hbWVcbiAgICAgICAgKS5yZXR1cm5zKGNhcklkSW5kZXgpXG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gY2FyU2VydmljZS5jaG9vc2VSYW5kb21DYXIoY2FyQ2F0ZWdvcnkpXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0gY2FyQ2F0ZWdvcnkuY2FySWRzW2NhcklkSW5kZXhdXG5cbiAgICAgICAgZXhwZWN0KGNhclNlcnZpY2UuZ2V0UmFuZG9tUG9zaXRpb24uY2FsbGVkT25jZSkudG8uYmUub2tcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZXF1YWwoZXhwZWN0ZWQpXG5cbiAgICB9KVxuIFxuICAgIGl0KCdnaXZlbiBhIGNhckNhdGVnb3kgaXQgc2hvdWxkIHJldHVybiBhbiBhdmFpbGFibGUgY2FyJywgYXN5bmMgICgpID0+IHtcbiAgICAgICAgY29uc3QgY2FyID0gbW9ja3MudmFsaWRDYXJcbiAgICAgICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpXG4gICAgICAgIGNhckNhdGVnb3J5LmNhcklkcyA9IFtjYXIuaWRdXG5cbiAgICAgICAgc2FuZGJveC5zdHViKFxuICAgICAgICAgICAgY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LFxuICAgICAgICAgICAgY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LmZpbmQubmFtZVxuICAgICAgICApLnJlc29sdmVzKGNhcilcblxuICAgICAgICBzYW5kYm94LnNweShcbiAgICAgICAgICAgIGNhclNlcnZpY2UsXG4gICAgICAgICAgICBjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhci5uYW1lXG4gICAgICAgIClcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYXJTZXJ2aWNlLmdldEF2YWlsYWJsZUNhcihjYXJDYXRlZ29yeSlcbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJcblxuICAgICAgICBleHBlY3QoY2FyU2VydmljZS5jaG9vc2VSYW5kb21DYXIuY2FsbGVkT25jZSkudG8uYmUub2tcbiAgICAgICAgZXhwZWN0KGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeS5maW5kLmNhbGxlZFdpdGhFeGFjdGx5KGNhci5pZCkpLnRvLmJlLm9rXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmRlZXAuZXF1YWwoZXhwZWN0ZWQpXG4gICAgfSlcblxuICAgIGl0KCdnaXZlbiBhIGNhckNhdGVnb3J5LCBjdXN0b21lciBhbmQgbnVtYmVyT2ZEYXlzIGl0IHNob3VsZCBjYWxjdWxhdGUgZmluYWwgYW1vdW50IGluIHJlYWwnLCBhc3luYyAoKT0+IHtcbiAgICAgICAgY29uc3QgY3VzdG9tZXIgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ3VzdG9tZXIpXG4gICAgICAgIGN1c3RvbWVyLmFnZSA9IDUwXG5cbiAgICAgICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpXG4gICAgICAgIGNhckNhdGVnb3J5LnByaWNlID0gMzcuNlxuXG4gICAgICAgIGNvbnN0IG51bWJlck9mRGF5cyA9IDVcblxuICAgICAgICBzYW5kYm94LnN0dWIoXG4gICAgICAgICAgICBjYXJTZXJ2aWNlLFxuICAgICAgICAgICAgXCJ0YXhlc0Jhc2VkT25BZ2VcIlxuICAgICAgICApLmdldCgoKT0+IFt7ZnJvbTogNDAsIHRvOjUwLCB0aGVuOjEuM31dKVxuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0gY2FyU2VydmljZS5jdXJyZW5jeUZvcm1hdC5mb3JtYXQoMjQ0LjQwKVxuICAgICAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmNhbGN1bGF0ZUZpbmFsUHJpY2UoXG4gICAgICAgICAgICBjdXN0b21lcixcbiAgICAgICAgICAgIGNhckNhdGVnb3J5LFxuICAgICAgICAgICAgbnVtYmVyT2ZEYXlzXG4gICAgICAgIClcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50by5iZS5kZWVwLmVxdWFsKGV4cGVjdGVkKVxuXG4gICAgfSlcblxuICAgIGl0KCdnaXZlbiBhIGN1c3RvbWVyIGFuZCBhIGNhciBjYXRlZ29yeSBpdCBzaG91bGQgcmV0dXJuIGEgdHJhbnNhY3Rpb24gcmVjZWlwdCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY2FyID0gbW9ja3MudmFsaWRDYXJcbiAgICAgICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSB7XG4gICAgICAgICAgICAuLi5tb2Nrcy52YWxpZENhckNhdGVnb3J5LFxuICAgICAgICAgICAgcHJpY2U6IDM3LjYsXG4gICAgICAgICAgICBjYXJJZHM6IFtjYXIuaWRdXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjdXN0b21lciA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDdXN0b21lcilcbiAgICAgICAgY3VzdG9tZXIuYWdlID0gMjBcblxuICAgICAgICBjb25zdCBudW1iZXJPZkRheXMgPSA1XG4gICAgICAgIGNvbnN0IGR1ZURhdGUgPSBcIjEwIGRlIG5vdmVtYnJvIGRlIDIwMjBcIlxuXG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoMjAyMCwxMCw1KVxuICAgICAgICBzYW5kYm94LnVzZUZha2VUaW1lcnModG9kYXkuZ2V0VGltZSgpKVxuXG4gICAgICAgIHNhbmRib3guc3R1YihcbiAgICAgICAgICAgIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeSxcbiAgICAgICAgICAgIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeS5maW5kLm5hbWVcbiAgICAgICAgKS5yZXNvbHZlcyhjYXIpXG4gICAgICAgXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkQW1vdW50ID0gY2FyU2VydmljZS5jdXJyZW5jeUZvcm1hdC5mb3JtYXQoMjA2LjgwKVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYXJTZXJ2aWNlLnJlbnQoY3VzdG9tZXIsY2FyQ2F0ZWdvcnksbnVtYmVyT2ZEYXlzKVxuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0gbmV3IFRyYW5zYWN0aW9uKHtcbiAgICAgICAgICAgIGN1c3RvbWVyLFxuICAgICAgICAgICAgY2FyLFxuICAgICAgICAgICAgZHVlRGF0ZSxcbiAgICAgICAgICAgIGFtb3VudDogZXhwZWN0ZWRBbW91bnRcbiAgICAgICAgfSlcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50by5iZS5kZWVwLmVxdWFsKGV4cGVjdGVkKVxuICAgIH0pXG59KSJdLCJtYXBwaW5ncyI6Im91TUFlWTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FmWixLQUFNLENBQUVFLFFBQVEsQ0FBRUMsRUFBRSxDQUFFQyxNQUFNLENBQUVDLFVBQVUsQ0FBRUMsU0FBVSxDQUFDLEVBQUFOLGNBQUEsR0FBQU8sQ0FBQSxNQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQ3hFLEtBQU0sQ0FBQUMsVUFBVSxFQUFBVCxjQUFBLEdBQUFPLENBQUEsTUFBR0MsT0FBTyxDQUFDLDhCQUE4QixDQUFDLEVBQzFELEtBQU0s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